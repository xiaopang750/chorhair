/*! company 罗格斯达 version 1.0.0 2015-06-17 */
define("widget/form/calendar",["../../util/http/loadCss"],function(e,t,r){var i=e("../../util/http/loadCss");i(R.uri.cssPath+"widget/form/calendar.css"),function(e,t,i){function n(e){var t=e.keyCode||e.charCode;return t>=48&&57>=t||t>=37&&40>=t||8==t||46==t}function o(e){var t=this,r={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":0==t.getHours()%12?12:t.getHours()%12,"H+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),w:"0123456".indexOf(t.getDay()),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in r)RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("00"+r[i]).substr((""+r[i]).length)));return e}function a(t,r){function n(t,r){return sting=e.trim(t),""!==t?(r=r.replace(/yyyy/,y4).replace(/yy/,y2).replace(/MM/,M2).replace(/M/,M1).replace(/dd/,d2).replace(/d/,d1).replace(/HH/,H2).replace(/H/,H1).replace(/mm/,m2).replace(/m/,m1).replace(/ss/,s2).replace(/s/,s1),r=RegExp("^"+r+"$"),a=r,r.test(t)):i}function o(e){var t,r=[],i=0;for(yi=e.indexOf("yyyy"),0>yi&&(yi=e.indexOf("yy")),yi>=0&&(r[i]=yi,i++),Mi=e.indexOf("MM"),0>Mi&&(Mi=e.indexOf("M")),Mi>=0&&(r[i]=Mi,i++),di=e.indexOf("dd"),0>di&&(di=e.indexOf("d")),di>=0&&(r[i]=di,i++),Hi=e.indexOf("HH"),0>Hi&&(Hi=e.indexOf("H")),Hi>=0&&(r[i]=Hi,i++),mi=e.indexOf("mm"),0>mi&&(mi=e.indexOf("m")),mi>=0&&(r[i]=mi,i++),si=e.indexOf("ss"),0>si&&(si=e.indexOf("s")),si>=0&&(r[i]=si,i++),t=[yi,Mi,di,Hi,mi,si],i=0;r.length-1>i;i++)for(j=0;r.length-1-i>j;j++)if(r[j]>r[j+1]){var n=r[j];r[j]=r[j+1],r[j+1]=n}for(i=0;r.length>i;i++)for(j=0;t.length>j;j++)r[i]==t[j]&&(t[j]=i);return t}var a,s=new Date;if(y4="([0-9]{4})",y2="([0-9]{2})",yi=-1,M2="(0[1-9]|1[0-2])",M1="([1-9]|1[0-2])",Mi=-1,d2="(0[1-9]|[1-2][0-9]|30|31)",d1="([1-9]|[1-2][0-9]|30|31)",di=-1,H2="([0-1][0-9]|20|21|22|23)",H1="([0-9]|1[0-9]|20|21|22|23)",Hi=-1,m2="([0-5][0-9])",m1="([0-9]|[1-5][0-9])",mi=-1,s2="([0-5][0-9])",s1="([0-9]|[1-5][0-9])",si=-1,n(t,r)){var c,l=a.exec(t),u=o(r),d=u[0]>=0?l[u[0]+1]:s.getFullYear(),h=u[1]>=0?l[u[1]+1]-1:s.getMonth(),f=u[2]>=0?l[u[2]+1]:s.getDate(),p=u[3]>=0?l[u[3]+1]:s.getHours(),m=u[4]>=0?l[u[4]+1]:s.getMinutes(),g=u[5]>=0?l[u[5]+1]:s.getSeconds(),c=new Date(d,h,f,p,m,g);return c.getDate()==f?c:s}return s}function s(t,r,i){var n=new Date;return/%/.test(t)?(i=i||0,t=t.replace(/%y/,n.getFullYear()).replace(/%M/,n.getMonth()+1).replace(/%d/,n.getDate()+i).replace(/%H/,n.getHours()).replace(/%m/,n.getMinutes()).replace(/%s/,n.getSeconds()).replace(d,"0$1")):/^#[\w-]+$/.test(t)&&(t=e.trim(e(t)[0].value),t.length>0&&r&&(t=o.call(a(t,r),"yyyy-MM-dd"))),t}function c(t,r){r=r||"click",e(u).on(r,t.ele,function(){return y(t),!1})}var l,u=t.document,d=/\b(\w)\b/g,h=!!t.ActiveXObject,f=h&&!t.XMLHttpRequest,p=e(t),m="JCA"+(new Date).getTime(),g=(function(e,t){for(var r,i=e.length;i>t&&(r=u.querySelector?e[t].src:e[t].getAttribute("src",4),-1===r.substr(r.lastIndexOf("/")).indexOf("lhgcalendar"));t++);return r.substr(0,r.lastIndexOf("/")+1)}(u.getElementsByTagName("script"),0),f?'<iframe id="lhgcal_frm" hideFocus="true" frameborder="0" src="about:blank" style="position:absolute;z-index:-1;width:100%;top:0px;left:0px;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>':""),v='<table class="lcui_border" border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><div class="lcui_head"><table width="100%" cellspacing="0" cellpadding="0" border="0"><tr><td width="14"><a class="cui_pm" href="javascript:void(0);"><</a></td><td width="40"><input class="cui_im" maxlength="4" value=""/>月</td><td><a class="cui_nm" href="javascript:void(0);">></a></td><td width="14"><a class="cui_py" href="javascript:void(0);"><</a></td><td width="60"><input class="cui_iy" maxlength="4" value=""/>年</td><td width="9"><a class="cui_ny" href="javascript:void(0);">></a></td></tr></table><div class="cui_ymlist" style="display:none;"><table width="100%" cellspacing="1" cellpadding="0" border="0"><thead class="cui_ybar"><tr><td><a class="cui_pybar" href="javascript:void(0);">«</a></td><td><a class="cui_cybar" href="javascript:void(0);">×</a></td><td><a class="cui_nybar" href="javascript:void(0);">»</a></td></tr></thead><tbody class="cui_lbox"></tbody></table></div></div><div class="lcui_body"><table cellspacing="1" cellpadding="0" border="0"><thead><tr><td>日</td><td>一</td><td>二</td><td>三</td><td>四</td><td>五</td><td>六</td></tr></thead><tbody class="cui_db"></tbody></table></div><div class="cui_foot"><table width="100%" cellspacing="0" cellpadding="0" border="0"><tr><td align="center" class="lcui_today"><a class="cui_tbtn" href="javascript:void(0);">今天</a></td><td align="center" class="lcui_time"><input class="cui_hour" maxlength="2"/>:<input class="cui_minute" maxlength="2"/>:<input class="cui_second" maxlength="2"/></td><td align="center" class="lcui_empty"><a class="cui_dbtn" href="javascript:void(0);">清空</a></td></tr></table></div></td></tr></tbody></table>'+g;try{u.execCommand("BackgroundImageCache",!1,!0)}catch(b){}var y=function(e){e=e||{};var t=y.setting;for(var r in t)e[r]===i&&(e[r]=t[r]);return l?l._init(e):new y.fn._init(e)};y.fn=y.prototype={constructor:y,_init:function(t){var r,i,n,o=this,c=o._getEvent();return o.config=t,o.DOM=r=o.DOM||o._getDOM(),o.evObj=c.srcElement||c.target,o.inpE=t.id?e(t.id)[0]:o.evObj,r.foot[0].style.display=t.btnBar?"":"none",t.minDate&&(t.minDate=s(t.minDate,t.targetFormat,t.noToday?1:0)),t.maxDate&&(t.maxDate=s(t.maxDate,t.targetFormat,t.noToday?-1:0)),i=e.trim(o.inpE.value),n=i.length>0?a(i,t.format):new Date,r.hour[0].value=o.config.defaultHour||(n.getHours()+"").replace(d,"0$1"),r.minute[0].value=o.config.defaultMinutes||(n.getMinutes()+"").replace(d,"0$1"),r.second[0].value=o.config.defaultSecond||(n.getSeconds()+"").replace(d,"0$1"),e("input",r.foot[0]).attr({disabled:t.format.indexOf("H")>=0?!1:!0}),o._draw(n).show()._offset(o.evObj),f&&e("#lhgcal_frm").css({height:r.wrap[0].offsetHeight+"px"}),l||(r.wrap[0].style.width=r.wrap[0].offsetWidth+"px",o._addEvent(),l=o),o},_draw:function(e,t){var r,i,n,o,a,c,l,h,f,p=this,m=p.DOM,g=[],v=p.config,b=0;p.year=o=e.getFullYear(),p.month=a=e.getMonth()+1,p.day=t||e.getDate(),m.iy[0].value=o,m.im[0].value=a,r=new Date(o,a-1,1).getDay(),i=new Date(o,a-1,0).getDate(),n=new Date(o,a,0).getDate();for(var y=0;r>y;y++)g.push(i),i--;g.reverse();for(var y=1;n>=y;y++)g.push(y);for(var y=1;42-n-r>=y;y++)g.push(y);c=u.createDocumentFragment();for(var y=0;6>y;y++){l=u.createElement("tr");for(var x=0;7>x;x++){if(h=u.createElement("td"),f=(o+"-"+a+"-"+g[b]).replace(d,"0$1"),r>b||b>=n+r||v.minDate&&v.minDate>f||v.maxDate&&f>v.maxDate||v.disWeek&&v.disWeek.indexOf(x)>=0)p._setCell(h,g[b]);else if(v.disDate){for(var w=0,k=v.disDate.length;k>w;w++){/%/.test(v.disDate[w])&&(v.disDate[w]=s(v.disDate[w]));var S=RegExp(v.disDate[w]),R=v.enDate?!S.test(f):S.test(f);if(R)break}R?p._setCell(h,g[b]):p._setCell(h,g[b],!0)}else p._setCell(h,g[b],!0);l.appendChild(h),b++}c.appendChild(l)}for(;m.db[0].firstChild;)m.db[0].removeChild(m.db[0].firstChild);return m.db[0].appendChild(c),p},_setCell:function(t,r,i){i?(t.innerHTML='<a href="javascript:void(0);">'+r+"</a>",t.firstChild[m+"D"]=r+"",r===this.day&&e(t).addClass("cui_today")):t.innerHTML=r+""},_drawList:function(e,t){for(var r,i,n=this.DOM,o=u.createDocumentFragment(),a=0;4>a;a++){r=u.createElement("tr");for(var s=0;3>s;s++)i=u.createElement("td"),i.innerHTML='<a href="javascript:void(0);">'+(t?t[e]:e)+"</a>",r.appendChild(i),t?i.firstChild[m+"M"]=e:i.firstChild[m+"Y"]=e,e++;o.appendChild(r)}for(;n.lbox[0].firstChild;)n.lbox[0].removeChild(n.lbox[0].firstChild);return n.lbox[0].appendChild(o),this},_showList:function(){this.DOM.ymlist[0].style.display="block"},_hideList:function(){this.DOM.ymlist[0].style.display="none"},_offset:function(){var t,r=this,i=r.DOM,n=e(r.evObj).offset(),o=n.top+r.evObj.offsetHeight,a=p.width(),s=p.height(),c=p.scrollLeft(),l=p.scrollTop(),u=i.wrap[0].offsetWidth,d=i.wrap[0].offsetHeight;return o+d>s+l&&(o=n.top-d-2),n.left+u>a+c&&(n.left-=u),i.wrap.css({left:n.left+"px",top:o+"px"}),t=i.im.offset().top+i.im[0].offsetHeight,i.ymlist[0].style.top=t-o+"px",r},_getDOM:function(){var t=u.createElement("div");t.style.cssText="position:absolute;display:none;z-index:"+this.config.zIndex+";",t.innerHTML=v;for(var r,i=0,n={wrap:e(t)},o=t.getElementsByTagName("*"),a=o.length;a>i;i++)r=o[i].className.split("cui_")[1],r&&(n[r]=e(o[i]));return u.body.appendChild(t),n},_getEvent:function(){if(h)return t.event;for(var e=this._getEvent.caller;null!=e;){var r=e.arguments[0];if(r&&(r+"").indexOf("Event")>=0)return r;e=e.caller}return null},_setDate:function(t){t=parseInt(t,10);var r,i,n=this,a=n.config,s=n.DOM,c=new Date(n.year,n.month-1,t);if(a.format.indexOf("H")>=0){var l=parseInt(s.hour[0].value,10),u=parseInt(s.minute[0].value,10),d=parseInt(s.second[0].value,10);c=new Date(n.year,n.month-1,t,l,u,d)}if(n.day=t,r=o.call(c,a.format),i=r.replace(/\-/gi,"/"),nowTime=new Date(i).getTime(),a.onSetDate&&a.onSetDate.call(n,r,nowTime),n.inpE.value=r,a.real){var h=a.format.indexOf("H")>=0?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd";e(a.real)[0].value=o.call(c,h)}n.hide()},_addEvent:function(){var t=this,r=t.DOM;r.wrap.bind("click",function(i){var n=i.target;if(n[m+"D"])t._setDate(n[m+"D"]);else if(n===r.pm[0])t._draw(new Date(t.year,t.month-2),t.day);else if(n===r.nm[0])t._draw(new Date(t.year,t.month),t.day);else if(n===r.py[0])t._draw(new Date(t.year-1,t.month-1),t.day);else if(n===r.ny[0])t._draw(new Date(t.year+1,t.month-1),t.day);else if(n===r.tbtn[0]){var o=new Date;t.year=o.getFullYear(),t.month=o.getMonth()+1,t.day=o.getDate(),t._setDate(t.day)}else if(n===r.dbtn[0]){var a=t.config;a.onSetDate&&(t.year="",t.month="",t.day="",a.onSetDate.call(t)),t.inpE.value="",t.hide(),a.real&&(e(a.real)[0].value="")}else{if(n===r.im[0]){var s=["01","02","03","04","05","06","07","08","09","10","11","12"],c=r.im.offset().left-parseInt(r.wrap[0].style.left,10);return r.im[0].select(),r.ybar[0].style.display="none",r.ymlist[0].style.left=c+"px",t._drawList(0,s)._showList(),!1}if(n===r.iy[0]){var c=r.iy.offset().left-parseInt(r.wrap[0].style.left,10);return r.iy[0].select(),r.ybar[0].style.display="",r.ymlist[0].style.left=c+"px",t._drawList(t.year-4)._showList(),!1}var o=new Date,l=r.im[0].value||o.getMonth()+1,u=r.iy[0].value||o.getFullYear();t._draw(new Date(u,l-1),t.day)}return t._hideList(),!1}),r.ymlist.bind("click",function(i){var n=i.target;if(n[m+"M"]>=0)r.im[0].value=n[m+"M"]+1,t._draw(new Date(t.year,n[m+"M"]),t.day)._hideList();else if(n[m+"Y"])r.iy[0].value=n[m+"Y"],t._draw(new Date(n[m+"Y"],t.month-1),t.day)._hideList();else if(n===r.pybar[0]){var o=e("a",r.lbox[0])[0][m+"Y"];t._drawList(o-12)}else if(n===r.nybar[0]){var o=e("a",r.lbox[0])[0][m+"Y"];t._drawList(o+12)}else n===r.cybar[0]&&t._hideList();return!1}),r.im.bind("keypress",n),r.iy.bind("keypress",n),r.hour.bind("keypress",n),r.minute.bind("keypress",n),r.second.bind("keypress",n),e(u).bind("click",function(e){e.target!==t.evObj&&t.hide()._hideList()})},show:function(){return this.DOM.wrap[0].style.display="block",this},hide:function(){return this.DOM.wrap[0].style.display="none",this},getDate:function(e){var t=this,r=t.DOM,i=parseInt(r.hour[0].value,10),n=parseInt(r.minute[0].value,10),o=parseInt(r.second[0].value,10);if(""===t.year&&""===t.month&&""===t.day)return"";switch(e){case"y":return t.year;case"M":return t.month;case"d":return t.day;case"H":return i;case"m":return n;case"s":return o;case"date":return t.year+"-"+t.month+"-"+t.day;case"dateTime":return t.year+"-"+t.month+"-"+t.day+" "+i+":"+n+":"+o}}},y.fn._init.prototype=y.fn,y.formatDate=function(e,t){return o.call(e,t)},y.setting={id:null,format:"yyyy-MM-dd",minDate:null,maxDate:null,btnBar:!0,targetFormat:null,disWeek:null,onSetDate:null,real:null,disDate:null,enDate:!1,zIndex:5e3,noToday:!1,linkageObj:null},t.lhgcalendar=y,r.exports=c}(this.jQuery||this.lhgcore,this)}),define("util/http/loadCss",[],function(e,t,r){function i(e){var t=document.getElementsByTagName("head")[0]||document.documentElement,r=document.createElement("link");r.rel="stylesheet",r.href=e,t.appendChild(r)}r.exports=i});