/*! company 罗格斯达 version 1.0.0 2015-06-17 */
define("widget/form/autoComplete",[],function(){function e(e){function t(){N.append(L),O=$("<ul></ul>"),L.append(O);for(var e=0;P>e;e++){var t=$("<li></li>");t.css({width:q,overflow:"hidden"}),t.html(S[e]),O.append(t)}}function r(){L.addClass(y),L.css({zIndex:b,display:"none",position:"absolute",left:A+"px",top:D+"px",border:E+"px solid "+k}),O.css({width:q+"px"})}function i(){v.keyup(function(e){var t=e.keyCode;if(38===t)T.length&&m(T);else if(40===t)T.length&&g(T);else if(13===t)T.length&&f(T[C]);else{var r=v.val();n(r)}}),v.keydown(function(e){var t=e.keyCode;9===t&&s()})}function n(e){var t=e.indexOf("@");if(-1!=t){var r=e.substring(t+1),i=e.substring(0,t+1);a(),o(r,i)}else if(e){a();for(var n=0;P>n;n++)c(O.children().eq(n),e+"@",n)}else s()}function o(e,t){T=[];for(var r=0,i=0;P>i;i++)-1!=S[i].indexOf(e)?c(O.children().eq(i),t,i):(r++,r===P?s():(a(),l(O.children().eq(i))))}function a(){L.show()}function s(){L.hide(),O.children().removeClass("acter"),C=-1,T=[]}function c(e,t,r){var i=t.length>R?t.substring(0,R)+"...@":t;e.attr("realData",t+S[r]),C=-1,e.show(),e.html("<span>"+i+S[r]+"</span>"),T.push(e)}function l(e){e.hide()}function u(){O.children().mouseover(function(){var e=O.children().index(this);C=e,p(O.children().eq(e))})}function d(){$(document).click(function(){s()})}function h(){O.children().click(function(){return f($(this)),s(),v.trigger("focus"),v.trigger("blur"),!1})}function f(e){e&&(v.val(e.attr("realData")),s())}function p(e){e.addClass("acter").siblings().removeClass("acter")}function m(e){var t=e.length;C--,0>C&&(C=t-1),p(e[C])}function g(e){var t=e.length;C++,C>t-1&&(C=0),p(e[C])}var v=e.ele||null,b=e.zIndex||1,y=e.sClass||"",x=e.moveLeft||0,w=e.moveTop||5,k=e.borderColor||"#000",S=e.data||[],R=e.maxLength||32,P=S.length,C=-1,T=[],q=v.innerWidth(),E=parseInt(v.css("borderLeftWidth")),k=v.css("borderLeftColor"),_=v.outerHeight(),A=v.position().left+x,D=v.position().top+_+w,N=v.parent(),L=$('<div script-role="autoTipWrap"></div>'),O=null;t(),r(),u(),h(),d(),i()}return e});