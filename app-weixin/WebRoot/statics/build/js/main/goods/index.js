define(function(e){e("../../driver/global"),e("../../touch/hammer");{var i=R.Class.create(R.util,{initialize:function(){this.curpage=1,this.pagesize=5,this.fairtype="",this.ready=!0,this.loading=$("[loading]"),this.windowHeigth=$(window).height(),this.scrollHeight=0,this.setHeight(),this.loadData(this.fairtype),this.events()},setHeight:function(){var e=$(".series").height();$(".series-item").height(e/2),$(".series-item").css("line-height",e/2+"px")},loadData:function(){var i=this,t=this.parse().type,s={pagesize:this.pagesize.toString(),curpage:this.curpage.toString(),contenttype:"combo",combotype:t,fairtype:this.fairtype};this.req("/content/querybykey.php",s,function(t){var s=$(".goods-list");if(""!=t.data){var a=JSON.parse(t.data),r={goodsArr:a},o=e("../../tpl/goods/list");i.render(s,o,r,"append");var n=$(".goods-list .img").width();$(".goods-list li").height(n),i.scrollHeight=document.documentElement.scrollHeight,i.ready=a.length==i.pagesize?!0:!1,i.loading.hide()}})},events:function(){var e=this;$(".series-list").hammer().on("tap",function(){e.showSeries()}),$(".series-list .close").hammer().on("tap",function(){return e.hideSeries(),!1}),$(".series-item").hammer().on("tap",function(){return $(".goods-list").html(""),e.curpage=1,$(this).addClass("active").siblings().removeClass("active"),$(".series-title .cn").html($(this).html()),e.fairtype=$(this).attr("fairtype"),e.loadData(e.fairtype),e.hideSeries(),!1}),$("[all-series-item]").hammer().on("tap",function(){return $(".goods-list").html(""),e.curpage=1,e.fairtype="",e.loadData(e.fairtype),e.hideSeries(),$(".series-item").removeClass("active"),$(".series-title .cn").html("系列"),!1}),$(window).on("scroll",function(){var i=$(this).scrollTop();e.scrollHeight-i<=e.windowHeigth+50&&e.ready&&(e.ready=!1,e.loading.show(),e.curpage++,e.loadData(e.fairtype))})},showSeries:function(){$(".series-wrap").css("-webkit-transform","translateX(0)"),setTimeout(function(){$(".series-wrap .close").show(),$("[all-series-item]").css("opacity",1)},100)},hideSeries:function(){$(".series-wrap").css("-webkit-transform","translateX(100%)"),$(".series-wrap .close").hide(),$("[all-series-item]").css("opacity",0)}});new i}});