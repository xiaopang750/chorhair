/*! company 罗格斯达 version 1.0.0 2015-06-17 */
define("widget/dom/cut",[],function(){function e(e,t){for(var r in t)e.style[r]=t[r]}function t(e,t){return e.currentStyle?e.currentStyle[t]:getComputedStyle(e,!1)[t]}function r(e,t,r){e.attachEvent?e.attachEvent("on"+t,r):e.addEventListener(t,r,!1)}function i(i){function n(){p.innerHTML="<img src="+k+">",p.id="cover_added",y=p.children[0],y.width=R,y.height=P,e(p,{position:"fixed",zIndex:12002,cursor:"move",left:N+"px",top:O+"px",width:L+"px",height:D+"px",background:"#fff",overflow:"hidden"});var t=document.getElementById("cover_added");t&&document.body.removeChild(t),document.body.appendChild(p)}function o(){e(y,{position:"absolute",left:-(N-T)+"px",top:-(O-A)+"px"})}function a(){f.id="shadow_added",e(f,{width:R+"px",height:P+"px",left:T+"px",top:A+"px",position:"fixed",zIndex:12001,background:"#000",opacity:.6,filter:"alpha(opacity=60)"});var t=document.getElementById("shadow_added");t&&document.body.removeChild(t),document.body.appendChild(f),r(window,"resize",function(){var t,r;t=$(m).offset().left,r=$(m).offset().top,e(f,{left:t+"px",top:r+"px"}),N=Math.floor((R-L)/2)+t,O=Math.floor((P-D)/2)+r,e(p,{left:N+"px",top:O+"px"}),e(y,{left:-(N-t)+"px",top:-(O-r)+"px"}),T=t,A=r})}function s(){g.style.overflow="hidden",g.style.position="relative",g.innerHTML="<img src="+k+">",x=g.children[0],x.style.position="absolute";var e=g.offsetWidth+parseInt(t(g,"borderLeftWidth"))+parseInt(t(g,"borderLeftWidth"));return e}function c(){for(var t=["lt","lb","rt","rb","l","r","t","b","c"],r=[],i=t.length,n=[{width:j+"px",height:M+"px",position:"absolute",zIndex:B,cursor:"nw-resize",overflow:"hidden",background:"#000",left:0,top:0,border:"1px solid #fff"},{width:j+"px",height:M+"px",position:"absolute",zIndex:B,cursor:"sw-resize",overflow:"hidden",background:"#000",left:0,bottom:0,border:"1px solid #fff"},{width:j+"px",height:M+"px",position:"absolute",zIndex:B,cursor:"ne-resize",overflow:"hidden",background:"#000",right:0,top:0,border:"1px solid #fff"},{width:j+"px",height:M+"px",position:"absolute",zIndex:B,cursor:"se-resize",overflow:"hidden",background:"#000",right:0,bottom:0,border:"1px solid #fff"},{width:I+"px",height:"100%",position:"absolute",zIndex:H,cursor:"w-resize",overflow:"hidden",background:"url("+W+") repeat-y",left:0,top:0},{width:I+"px",height:"100%",position:"absolute",zIndex:H,cursor:"e-resize",overflow:"hidden",background:"url("+W+") repeat-y",right:0,top:0},{width:"100%",height:U+"px",position:"absolute",zIndex:H,cursor:"n-resize",overflow:"hidden",background:"url("+W+") repeat-x",left:0,top:0},{width:"100%",height:U+"px",position:"absolute",zIndex:H,cursor:"s-resize",overflow:"hidden",background:"url("+W+") repeat-x",left:0,bottom:0},{width:"95%",height:"95%",position:"absolute",zIndex:H,cursor:"move",overflow:"hidden",background:"#000",left:"2.5%",top:"2.5%",opacity:"0",filter:"alpha(opacity=0)"}],o=0;i>o;o++){var a=document.createElement("div");a.className=t[o],e(a,n[o]),r.push(a),p.appendChild(a)}return r}function l(e){for(var t=e.length,r=0;t>r;r++)u(e[r])}function u(e){var t=e.parentNode,r=27,i=37;e.onmousedown=function(n){function o(n){var o=n||event,a=document.documentElement.scrollTop||document.body.scrollTop,s=document.documentElement.scrollLeft||document.body.scrollLeft;if(-1!=e.className.indexOf("l")){var c=o.clientX-u;c>=d-r&&(c=d-r),T-f>=c&&(c=T-f),d*F+t.offsetTop-P-A>=c*F&&(c=(d*F+t.offsetTop-P-A)*(1/F));var l=d-c,w=f+c,k=-(w-T);t.style.width=l+"px",t.style.height=l*F+"px",t.style.left=w+"px",y.style.left=k+"px"}if("r"==e.className){var S=o.clientX-m+e.offsetWidth;r>S&&(S=r),S>=R-(t.offsetLeft-T)&&(S=R-(t.offsetLeft-T)),F*S>=P-(t.offsetTop-A)&&(S=(P-(t.offsetTop-A))*(1/F)),t.style.width=S+"px",t.style.height=F*S+"px"}if(-1!=e.className.indexOf("t")){var C=o.clientY-g;C>=v-i&&(C=v-i),A-b>=C&&(C=A-b),t.offsetLeft+v*(1/F)-T-R>=C*(1/F)&&(C=(t.offsetLeft+v*(1/F)-T-R)*F);var q=v-C,$=b+C,E=-($-A);t.style.height=q+"px",t.style.width=q*(1/F)+"px",t.style.top=$+"px",y.style.top=E+"px"}if(-1!=e.className.indexOf("b")){var _=o.clientY-x+e.offsetHeight;i>=_&&(_=i),_>=P-(t.offsetTop-A)&&(_=P-(t.offsetTop-A)),_*(1/F)>=R-(t.offsetLeft-T)&&(_=(R-(t.offsetLeft-T))*F),t.style.height=_+"px",t.style.width=_*(1/F)+"px"}if("lt"==e.className){var c=o.clientX-u;c>=d-r&&(c=d-r),T-f>=c&&(c=T-f),A-b>=c&&(c=A-b),-(c/F/2)>P-(b-A+v)&&(c=2*-(P-(b-A+v))*F);var l=d-c,w=f+c,k=-(w-T),q=v-c,$=b+c,E=-($-A);t.style.width=l+"px",t.style.height=l*F+"px",t.style.left=w+"px",t.style.top=$+"px",y.style.left=k+"px",y.style.top=E+"px"}if("lb"==e.className){var c=o.clientX-u;c>=d-r&&(c=d-r),T-f>=c&&(c=T-f),d*F+t.offsetTop-P-A>=c*F&&(c=(d*F+t.offsetTop-P-A)*(1/F));var l=d-c,w=f+c,k=-(w-T);t.style.width=l+"px",t.style.height=l*F+"px",t.style.left=w+"px",y.style.left=k+"px"}if(-1!=e.className.indexOf("c")){var S=o.clientX-m-s,_=o.clientY-x-a,L=T,D=T+R-t.offsetWidth,N=A,O=A+P-t.offsetHeight;L>S&&(S=L),S>D&&(S=D),N>_&&(_=N),_>O&&(_=O);var k=-(S-T),j=-(_-A);y.style.left=k+"px",y.style.top=j+"px",e.parentNode.style.left=S+"px",e.parentNode.style.top=_+"px"}h(t.offsetWidth,p.offsetLeft,p.offsetTop)}function a(){this.onmouseup=null,this.onmousemove=null,this.releaseCapture&&this.releaseCapture()}var s=n||event,c=document.documentElement.scrollTop||document.body.scrollTop,l=document.documentElement.scrollLeft||document.body.scrollLeft;if(-1!=e.className.indexOf("l"))var u=s.clientX,d=t.offsetWidth,f=t.offsetLeft;if(-1!=e.className.indexOf("r"))var m=s.clientX-this.offsetLeft-l;if(-1!=e.className.indexOf("t"))var g=s.clientY,v=t.offsetHeight,b=t.offsetTop;if(-1!=e.className.indexOf("b"))var x=s.clientY-this.offsetTop;if(-1!=e.className.indexOf("c"))var m=s.clientX-t.offsetLeft-l,x=s.clientY-t.offsetTop-c;return e.setCapture?(e.onmousemove=o,e.onmouseup=a,e.setCapture()):(document.onmousemove=o,document.onmouseup=a),!1}}function d(){var e=RegExp("http://"+window.location.host,"gi");b.onclick=function(){var t={};t.scale=C>q?P/q:R/C,t.tmpimg=m.src.split("?")[0].replace(e,""),t.x=(p.offsetLeft-T)/t.scale,t.y=(p.offsetTop-A)/t.scale,t.cutwidth=p.offsetWidth/t.scale,t.cutheight=t.cutwidth*F,t.oldWidth=C,S&&S(t)}}function h(e,t,r){var i=t-T,n=r-A,o=R/(e-2*I),a=R/v,s=R*o/a,c=-i*o/a,l=-n*o/a;x.width=s,x.style.left=c+"px",x.style.top=l+"px"}var f=document.createElement("div"),p=document.createElement("div"),m=i.oImage||null,g=i.oView||null,v=0,b=i.oSubmintBtn||null,y=null,x=null,w=null,k=m.src,S=i.fnDo||null,R=i.width||0,P=i.height||0,C=i.oldWidth||0,q=i.oldHeight||0,T=i.left||0,A=i.top||0,E=parseInt(i.scaleWidth)||"",_=parseInt(i.scaleHeight)||"",L=Math.floor(R*E/100),D=Math.floor(R*_/100),N=Math.floor((R-L)/2)+T,O=Math.floor((P-D)/2)+A,j=i.dotWidth||6,M=i.dotHeight||6,B=i.dotIndex||6,I=i.lineWidth||2,U=i.lineHeight||2,H=i.lineIndex||5,W=i.lineUrl||"/static/images/lib/global/line.gif",F=i.cutScale||_/E;n(),o(),a(),v=s(),h(p.offsetWidth,p.offsetLeft,p.offsetTop),w=c(),l(w),d()}return i});