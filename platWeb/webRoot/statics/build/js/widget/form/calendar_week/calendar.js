/*! company 罗格斯达 version 1.0.0 2015-06-17 */
define("widget/form/calendar_week/calendar",["../../dom/dialog"],function(e,t,r){function i(e,t,r){window.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)}function n(){return this.winHeight,window.innerHeight?this.winHeight=window.innerHeight:document.body&&document.body.clientHeight&&(this.winHeight=document.body.clientHeight),document.documentElement&&document.documentElement.clientHeight&&(this.winHeight=document.documentElement.clientHeight),this.winHeight}function o(e){return this.domObj=document.getElementById(e),this.domObj?(this.domObj.addClass=function(e){var t=this.className;return 0==t.length?(this.className=t,void 0):(t==e||t.match(RegExp("(^|\\s)"+e+"(\\s|$)"))||(this.className=t+" "+e),void 0)},this.domObj.removeClass=function(e){var t=this.className;if(0!=t.length)return t==e?(this.className="",void 0):(t.match(RegExp("(^|\\s)"+e+"(\\s|$)"))&&(this.className=t.replace(RegExp("(^|\\s)"+e+"(\\s|$)")," ")),void 0)},this.domObj.hasClass=function(e){var t=this.className;return 0==t.length?!1:t==e||t.match(RegExp("(^|\\s)"+e+"(\\s|$)"))?!0:!1},this.domObj):void 0}function a(e,t,r){for(var i=e.getElementsByTagName(t),n=0,o=i.length,a=[];o>n;n++)i[n].className==r&&a.push(i[n]);return 1==a.length&&(a=a[0]),a}function s(e){return document.createElement(e)}function c(e){e.wrap.html('<div id="main"><div id="tool"></div><div id="calendar"></div><div id="append" ></div></div>');try{var t=new q;t.date=e.date,t.mode=e.mode,t.dialog=S,t.language=new R(e.language),t.load(),t.tool()}catch(r){alert("抱歉，出现异常："+r)}return t}function l(e,t){var r=[31,28,31,30,31,30,31,31,30,31,30,31];if(1==t)var i=0==e%4&&0!=e%100||0==e%400?29:28;else var i=r[t];return i}function u(e){if(o("day_"+e)){o("day_"+e).addClass("day_pc");var t=o("rday"),r=t.value;o("add_"+e).style.display="block";var i=o("date"),n=new Date(i.value);if(n.getMonth()+1,n.getFullYear(),r){if(r!="day_"+e){o(r).removeClass("day_pc");var a=r.split("_");o("add_"+a[1]).style.display="none",o("rday").value="day_"+e}}else o("rday").value="day_"+e}}function d(e){if(N){var t=a(document,"div","wc-scrollable-grid");"up"==e?t.scrollTop-=10:"down"==e&&(t.scrollTop+=10),D=setTimeout("setScrollTop('"+e+"')",100)}}function h(){o(E+""+O+"_event_div")&&o(E+""+O+"_event_div").parentNode.removeChild(o(E+""+O+"_event_div"))}function f(e,t,r,i){S.show(),window.__nowTime=e,window.__calendarOnShow&&window.__calendarOnShow(e,i)}function p(e){var t,r=348;for(t=32768;t>8;t>>=1)r+=B[e-1900]&t?1:0;return r+m(e)}function m(e){return g(e)?65536&B[e-1900]?30:29:0}function g(e){return 15&B[e-1900]}function v(e,t){return B[e-1900]&65536>>t?30:29}function b(e){var t,r=0,i=0,n=new Date(1900,0,31),o=(e-n)/864e5;for(this.daycyl=o+40,this.moncyl=14,t=1900;2050>t&&o>0;t++)i=p(t),o-=i,this.moncyl+=12;for(0>o&&(o+=i,t--,this.moncyl-=12),this.year=t,this.yearcyl=t-1864,r=g(t),this.isleap=!1,t=1;13>t&&o>0;t++)r>0&&t==r+1&&0==this.isleap?(--t,this.isleap=!0,i=m(this.year)):i=v(this.year,t),1==this.isleap&&t==r+1&&(this.isleap=!1),o-=i,0==this.isleap&&this.moncyl++;0==o&&r>0&&t==r+1&&(this.isleap?this.isleap=!1:(this.isleap=!0,--t,--this.moncyl)),0>o&&(o+=i,--t,--this.moncyl),this.month=t,this.day=o+1}function y(e,t){var r,i=["日","一","二","三","四","五","六","七","八","九","十"],n=["初","十","廿","卅","　"];switch(r=e>10?"十"+i[e-10]:i[e],r+="月","十二月"==r&&(r="腊月"),"一月"==r&&(r="正月"),t){case 10:r+="初十";break;case 20:r+="二十";break;case 30:r+="三十";break;default:r+=n[Math.floor(t/10)],r+=i[t%10]}return r}function x(e){var t=new Date(e),r=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=new b(r),n=y(i.month,i.day);return n}e("../../../../css/widget/form/calendar_week/calendar.css");var w=e("../../dom/dialog"),k='<div class="nr-box calendar-week-box"><a href="javascript:;" class="close" sc="close">×</a><div class="inner-wrap"><div class="mb-10"><p>标题：</p><input class="form-control" calendar-name></div><div class="mb-10"><p>内容：</p><textarea class="form-control h-sm" calendar-content></textarea></div><div><a class="btn btn-primary" href="javascript:;" calendar-btn>确定</a></div></div></div>',S=new w({boxStr:k});Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"s+":this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in t)RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e},Date.prototype.addDays=function(e){this.setDate(this.getDate()+e)},Date.prototype.addWeeks=function(e){this.addDays(7*e)},Date.prototype.addMonths=function(e){var t=this.getDate();this.setMonth(this.getMonth()+e),t>this.getDate()&&this.setDate(0)},Date.prototype.addYears=function(e){var t=this.getMonth();this.setFullYear(this.getFullYear()+e),this.getMonth()>t&&this.setDate(0)};var R=function(e){return this.language="chinese"==e?P:C,this.language.timeArray=[12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11],this.language.time12hm=["12:00 am","12:30 am","1:00 am","1:30 am","2:00 am","2:30 am","3:00 am","3:30 am","4:00 am","4:30 am","5:00 am","5:30 am","6:00 am","6:30 am","7:00 am","7:30 am","8:00 am","8:30 am","9:00 am","9:30 am","10:00 am","10:30 am","11:00 am","11:30 am","12:00 pm","12:30 pm","1:00 pm","1:30 pm","2:00 pm","2:30 pm","3:00 pm","3:30 pm","4:00 pm","4:30 pm","5:00 pm","5:30 pm","6:00 pm","6:30 pm","7:00 pm","7:30 pm","8:00 pm","8:30 pm","9:00 pm","9:30 pm","10:00 pm","10:30 pm","11:00 pm","11:30 pm","12:00 pm","12:30 pm"],this.language},P={type:"chinese",weekArray:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],week:"周",year:"年",month:"月",day:"日",date:"日期",title:"标题",content:"内容",event:"事件",create_action:"创建事件",edit_detail:"编辑活动详细信息",today:"今天"},C={type:"english",weekArray:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthArray:["January","February","March","April","May","June","July","August","September","October","November","December"],week:"Week",year:"Year",month:"Month",day:"Day",date:"Date",title:"Title",content:"Content",event:"Event",create_action:"Create Event",edit_detail:"Edit Detail",today:"Today"},q=function(){this.date,this.language,this.toolBar=o("tool"),this.content=o("calendar"),this.content.innerHTML="",this.mode};q.prototype.load=function(){this.header(),this.list(),this.status()},q.prototype.tool=function(){this.c_tl_tb=s("table"),this.c_tl_tbody=s("tbody"),this.c_tl_tb_tr=s("tr"),this.c_tl_tb_td_1=s("td"),this.c_tl_tb_td_2=s("td"),this.year_a=s("a"),this.month_a=s("a"),this.week_a=s("a"),this.day_a=s("a"),this.prevMonth_div=s("div"),this.nextMonth_div=s("div"),this.prevMonth_div.className="prevMonth",this.nextMonth_div.className="nextMonth",this.language_input=s("input"),this.language_input.type="hidden",this.language_input.id="hidden_language",this.language_input.value=this.language.type,this.tab_input=s("input"),this.tab_input.type="hidden",this.tab_input.id="tab_input",this.tab_input.value=this.mode,this.c_tl_tb.className="Calendar",this.c_tl_tb_tr.className="CalendarOtherMonthDay",this.c_tl_tb_td_1.width="200",this.c_tl_tb_td_1.style.padding="3px",this.c_tl_tb_td_1.style.display="none",this.c_tl_tb_td_1.style.textAlign="left",this.c_tl_tb_td_2.style.padding="3px",this.c_tl_tb_td_2.style.textAlign="left",i(this.prevMonth_div,"click",Prev),i(this.nextMonth_div,"click",Next),this.c_tl_tb_td_1.appendChild(this.year_a),this.c_tl_tb_td_1.appendChild(this.month_a),this.c_tl_tb_td_1.appendChild(this.week_a),this.c_tl_tb_td_1.appendChild(this.day_a),this.c_tl_tb_td_2.appendChild(this.prevMonth_div),this.c_tl_tb_td_2.appendChild(this.nextMonth_div),this.c_tl_tb_td_2.appendChild(this.language_input),this.c_tl_tb_td_2.appendChild(this.tab_input),this.c_tl_tb_tr.appendChild(this.c_tl_tb_td_1),this.c_tl_tb_tr.appendChild(this.c_tl_tb_td_2),this.c_tl_tbody.appendChild(this.c_tl_tb_tr),this.c_tl_tb.appendChild(this.c_tl_tbody),this.toolBar.appendChild(this.c_tl_tb)},q.prototype.status=function(){this.status=s("div"),this.status.className="CalendarNavigator",this.status.id="grid_bottom",this.status.colspan="1",this.status.style.textAlign="left",i(this.status,"mouseover",function(){d("down")}),i(this.status,"mouseout",function(){clearTimeout(D)}),this.content.appendChild(this.status)};var T=function(e){var t=new Date;return"string"==typeof e&&(e=new Date(e)),t.format("yyyyMMdd")==e.format("yyyyMMdd")?!0:!1};q.prototype.header=function(){this.c_h_tb=s("table"),this.c_h_tbody=s("tbody"),this.c_h_tb_tr=s("tr"),this.c_h_tb_td_l=s("td"),this.c_h_tb_th=s("th"),this.c_h_tb_td_c=s("td"),this.c_h_tb_td_r=s("td"),this.c_h_tb_td_img=s("img"),this.c_h_tb_td_img2=s("img"),this.c_h_tb.className="Header",this.c_h_tb.cellspacing="0",this.c_h_tb.cellpadding="0",this.c_h_tb.border="0",this.c_h_tb_td_l.className="HeaderLeft",this.c_h_tb_td_r.className="HeaderRight",this.c_h_tb_td_c.className="tbg",this.hid=s("input"),this.hid_rday=s("input"),this.hid_rday.type="hidden",this.hid_rday.id="rday",this.hid.type="hidden",this.hid.value=this.date.format("MM/dd/yyyy"),this.hid.id="date",this.c_h_tb_th.innerHTML="chinese"==this.language.type?'<a class="br10" >'+this.date.getFullYear()+"</a> "+this.language.year+' <a class="br10">'+(this.date.getMonth()+1)+"</a> "+this.language.month:this.date.getFullYear()+" "+this.language.monthArray[this.date.getMonth()],this.c_h_tb_td_l.appendChild(this.c_h_tb_td_img),this.c_h_tb_td_r.appendChild(this.c_h_tb_td_img2),this.c_h_tb_sz=s("a"),this.c_h_tb_sz.className="c_sz",this.c_h_tb_td_c.appendChild(this.c_h_tb_sz),this.c_h_tb_td_c.appendChild(this.hid),this.c_h_tb_td_c.appendChild(this.hid_rday),this.c_h_tb_tr.appendChild(this.c_h_tb_td_l),this.c_h_tb_tr.appendChild(this.c_h_tb_th),this.c_h_tb_tr.appendChild(this.c_h_tb_td_c),this.c_h_tb_tr.appendChild(this.c_h_tb_td_r),this.c_h_tbody.appendChild(this.c_h_tb_tr),this.c_h_tb.appendChild(this.c_h_tbody),this.content.appendChild(this.c_h_tb)},q.prototype.list=function(){this.c_h_tb=s("table"),this.c_h_tbody=s("tbody"),this.c_h_tb_tr_top=s("tr"),this.c_h_tb_td_top=s("td"),this.c_h_tb_td_top.valign="top",this.c_h_tb.className="Calendar",this.grid=new A(this.date,this.language),this.c_h_tb_td_top.appendChild(this.grid),this.c_h_tb_tr_top.appendChild(this.c_h_tb_td_top),this.c_h_tbody.appendChild(this.c_h_tb_tr_top),this.c_h_tb.appendChild(this.c_h_tbody),this.content.appendChild(this.c_h_tb)};var A=function(e,t){this.c_g_tb=s("table"),this.c_g_tbody=s("tbody"),this.c_g_tb.className="Grid",this.day=0,this.date=new Date(e.format("MM/01/yyyy")),this.w=this.date.getDay(),this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.days=0,this.days=l(this.year,this.month),this.week=t.weekArray,this.ndate=new Date,parseInt(400)/5;for(var r=0;6>r;r++){if(this.c_g_tr=s("tr"),0==r)for(var i=0;7>i;i++)this.c_g_td=s("td"),this.c_g_td.className="CalendarWeekendName",this.c_g_td.style.width="14.29%",this.c_g_td.innerHTML=this.week[i],this.c_g_td.style.background="#eee",this.c_g_tr.appendChild(this.c_g_td);else{this.c_g_tr.className="grid-tr",this.c_g_tr.style.height=(n()-95)/5+"px";for(var i=0;7>i;i++){var o=new _(t,this.year,this.month,this.day,this.date,this.ndate,r,i,this.w,this.days);this.day=o.day,this.c_g_tr.appendChild(o.c_g_td)}}this.c_g_tbody.appendChild(this.c_g_tr)}return this.c_g_tb.appendChild(this.c_g_tbody),this.c_g_tb},_=function(e,t,r,n,o,a,c,l,d,h){this.c_g_td=s("td"),this.c_g_td.className="CalendarWeekend",this.c_g_td.style.verticalAlign="top",this.c_g_td.style.textAlign="left",this.day;var f="";if(1==c&&l>=d){n++;var p="";if("chinese"==e.type)var m=r+1+"/"+n+"/"+t,g=x(r+1+"//"+n+"//"+t),p="  <font color='#777' style='font-size:8px'>"+g+"</font>";this.c_g_td.id="day_"+n,this.c_g_td.setAttribute("nowTime",m);var f="<div class='day_d' ><a class='day_num'>"+n+"</a>"+p+"</font><a class='add_event'  id='add_"+n+"'><img src='../statics/assets/lib/widget/calendar_week/add.gif' calendar-plane="+o.format("MM/"+n+"/yyyy")+"><a/></div>"}else if(c>1&&h>n){n++;var p="";if("chinese"==e.type)var g=x(r+1+"//"+n+"//"+t),m=r+1+"/"+n+"/"+t,p="&nbsp;&nbsp;<font color='#777' style='font-size:8px'>"+g+"</font>";this.c_g_td.id="day_"+n,this.c_g_td.setAttribute("nowTime",m);var f="<div class='day_d' ><a class='day_num'>"+n+"</a>"+p+"</font><a class='add_event'  id='add_"+n+"'><img src='../statics/assets/lib/widget/calendar_week/add.gif' calendar-plane="+o.format("MM/"+n+"/yyyy")+"><a/></div>"}else{var f=" ";this.c_g_td.style.background="#eeeeee"}return i(this.c_g_td,"click",function(){u(n)}),this.day=n,this.c_g_td.innerHTML=f,T(o.format("MM/"+n+"/yyyy"))&&(this.c_g_td.className+=" today"),this};$(document).on("click","[calendar-plane]",function(){var e=$(this).attr("calendar-plane");return f(e,18,34,$(this)),!1}),clickDay=function(e){var t=o("eventbyDay"),r=o("date"),i=new Date(r.value);t.innerHTML=i.getMonth()+1+"月"+e+"日"},Next=function(){var e=o("date"),t=new Date(e.value);t.addMonths(1),L(t)},Prev=function(){var e=o("date"),t=new Date(e.value);t.addMonths(-1),L(t)};var E,D,L=function(e){var t="english",r=o("hidden_language");r&&(t=r.value);try{var i=new q;i.date=e,i.language=new R(t),i.load(),window.__onRender&&window.__onRender()}catch(n){alert(n)}},N=!1,O=0,j=!1;window.onmouseup=function(){N=!1,j||h()};var M=!1,I=!1;window.onresize=function(){if(M||(M=a(document,"div","wc-scrollable-grid")),I||(I=a(document,"tr","grid-tr")),"month"==o("tab_input").value)for(var e=0;I.length>e;e++)I[e].style.height=(n()-95)/5+"px";else"week"==o("tab_input").value?M.style.height=n()-95+"px":"day"==o("tab_input").value&&(M.style.height=n()-69+"px")};var B=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448];r.exports=c}),define("widget/dom/dialog",[],function(e,t,r){function i(e){e=e||{},this.type=e.type||"confirm",this.title=e.title||"",this.content=e.content||"",this.enterKey=e.enterKey?e.enterKey:!1,this.escKey=e.escKey?e.escKey:!1,this.index=e.index||4e3,this.box=null,this.boxStr=e.boxStr||'<div class="confirmbox out-box '+this.type+'" sc="confirm-box" sc="box">'+'<h2 class="ba-tc ba-font-18 ba-red ba-mt-20" sc="box-title">'+this.title+"</h2>"+'<p class="ba-font-20 ba-tc ba-mt-10 ba-mb-10" sc="box-content">'+this.content+"</p>"+'<div class="ba-tc">'+'<a href="javascript:;" class="btn btn-danger ba-mr-10" sc="confirm">确定</a>'+'<a href="javascript:;" class="btn btn-primary" sc="close">取消</a>'+"</div>"+"</div>",this.boxSelector=e.boxSelector||"",this.boxTpl=e.boxTpl||"",this.boxData=e.boxData||{},this.onClosed=e.onClosed||null,this.onStart=e.onStart||null,this.onConfirm=e.onConfirm||null,this.overLayHide=e.overLayHide||null,this.init()}i.prototype={init:function(){this.render(),this.events(),this.makeLay()},render:function(){var e,t,r=this.create();e=-r.h/2+"px",t=-r.w/2+"px",this.position(r.box,"50%","50%",e+" 0 0 "+t),this.box=r.box},makeRound:function(){var e='<div class="clearfix level-t"><div class="lt fl"></div><div class="t fl"></div><div class="rt fl"></div></div><div class="clearfix level-m"><div class="l fl"></div><div class="main fl"></div><div class="r fl"></div></div><div class="clearfix level-b"><div class="lb fl"></div><div class="b fl"></div><div class="rb fl"></div></div>';this.boxSelector.append($(e))},makeLay:function(){var e=$("[sc = Dialog-lay]").length;return e?(this.oLay=$("[sc = Dialog-lay]"),void 0):(this.oLay=$('<div sc="Dialog-lay"></div>'),this.oLay.css({width:"100%",height:"100%",position:"fixed",left:0,top:0,zIndex:3e3,background:"#000",opacity:"0.3",display:"none"}),$("body").append(this.oLay),void 0)},set:function(e,t){this.oLay.css({left:e,top:t})},create:function(){var e,t,r;return this.boxSelector?e=$(this.boxSelector):this.boxTpl?(e=$(this.boxTpl(this.boxData)),$("body").append(e)):(e=$(this.boxStr),$("body").append(e)),e.wrap("<div dialog-wrap></div>"),t=e.outerWidth(!0),r=e.outerHeight(!0),this.oBox=e,this.oWrap=this.oBox.parents("[dialog-wrap]"),{box:this.oWrap,w:t,h:r}},events:function(){var e=this;this.box.on("click","[sc = close]",function(){e.close(e.box)}),this.box.on("click","[sc = confirm]",function(){e.onConfirm&&e.onConfirm.call(e,$(this))}),$(document).on("click",function(t){e.overLayHide&&$(t.target).parents()[0]!=e.oBox[0]&&$(t.target)[0]!=e.oBox[0]&&e.close()})},position:function(e,t,r,i){e.css({position:"fixed",left:t,top:r,margin:i,zIndex:this.index,display:"none"})},show:function(){this.oWrap.show(),this.oLay.show(),this.onStart&&this.onStart.call(this)},close:function(e){this.oWrap.hide(),this.oLay.hide(),e!==!1&&this.onClosed&&this.onClosed.call(this)},fix:function(){this.box.css("position","fixed")},dom:function(){return this.oBox},boxTitle:function(){return this.oBox.find("[sc = box-title]")},boxContent:function(){return this.oBox.find("[sc = box-content]")},refreshData:function(e){this.oWrap.html(this.boxTpl(e))}},r.exports=i});